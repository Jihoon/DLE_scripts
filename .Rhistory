mutate(tot.gdp.min.2050.dirty=gdp.pcap.dirty*pop.SSP4/1e12, cum.gdp.min.dirty = cumsum(tot.gdp.min.2050.dirty), cum.ene.min.dirty = cumsum(int.min.dirty*tot.gdp.min.2050.dirty)) %>%
arrange(int.min.clean) %>%
mutate(tot.gdp.min.2050.clean=gdp.pcap.clean*pop.SSP4/1e12, cum.gdp.min.clean = cumsum(tot.gdp.min.2050.clean), cum.ene.min.clean = cumsum(int.min.clean*tot.gdp.min.2050.clean)) %>%
arrange(int.min.SSP4) %>%
mutate(tot.gdp.min.2050=gdp.pcap.SSP4*pop.SSP4/1e12, cum.gdp.min = cumsum(tot.gdp.min.2050), cum.ene.min = cumsum(int.min.SSP4*tot.gdp.min.2050)) %>%
arrange(int.base.dirty) %>%
mutate(tot.gdp.2050.dirty=gdp.pcap.dirty*pop.SSP4/1e12, cum.gdp.dirty = cumsum(tot.gdp.2050.dirty), cum.ene.dirty = cumsum(int.base.dirty*tot.gdp.2050.dirty)) %>%
arrange(int.base.clean) %>%
mutate(tot.gdp.2050.clean=gdp.pcap.clean*pop.SSP4/1e12, cum.gdp.clean = cumsum(tot.gdp.2050.clean), cum.ene.clean = cumsum(int.base.clean*tot.gdp.2050.clean)) %>%
arrange(int.base.SSP4) %>%
mutate(tot.gdp.2050=gdp.pcap.SSP4*pop.SSP4/1e12, cum.gdp = cumsum(tot.gdp.2050), cum.ene = cumsum(int.base.SSP4*tot.gdp.2050)) # GDP in trillion $2005
View(cum.plot.data %>% select(starts_with("cum.")))
ggplot(cum.plot.data , aes(x=cum.gdp, y=int.base.SSP4)) + geom_step(aes(color="SSP4 (g=0.45, e=0.89)")) +
geom_step(aes(x=cum.gdp.dirty, y=int.base.dirty, color="Dirty (g=0.3, e=0.89)")) +
geom_step(aes(x=cum.gdp.clean, y=int.base.clean, color="Clean (g=0.3, e=0.89)")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(y="Energy intensity (kgoe/$)", x="Total GDP (trillion PPP$ 2005)") +
geom_text(aes(x=cum.gdp.dirty, y=int.base.dirty, label=formatC(cum.ene.dirty, digits = 1, format="f")), size = 2.5, hjust=1) +
geom_text(aes(x=cum.gdp.clean, y=int.base.clean, label=formatC(cum.ene.clean, digits = 1, format="f")), size = 2.5, hjust=1)
ggplot(cum.plot.data %>% arrange(tot.gdp.min.2050), aes(x=cum.gdp.min, y=cum.ene.min)) +
geom_step(aes(color="SSP4 (g=0.45, e=0.70)"), direction="vh") +
geom_text(data=cum.plot.data %>% filter(tot.gdp.min.2050>5), aes(label=iso3c), size = 2.5) +
geom_step(aes(x=cum.gdp.min.dirty, y=cum.ene.min.dirty, color="Dirty (g=0.3, e=0.70)"), direction="vh") +
geom_text(data=cum.plot.data %>% filter(tot.gdp.min.2050>5), aes(x=cum.gdp.min.dirty, y=cum.ene.min.dirty, label=iso3c), size = 2.5) +
geom_step(aes(x=cum.gdp.min.clean, y=cum.ene.min.clean, color="Clean (g=0.3, e=0.70)"), direction="vh") +
geom_text(data=cum.plot.data %>% filter(tot.gdp.min.2050>5), aes(x=cum.gdp.min.clean, y=cum.ene.min.clean, label=iso3c), size = 2.5) +
labs(y="Energy (kgoe)", x="Total GDP (trillion PPP$ 2005)") #+
# geom_text(aes(x=cum.gdp.dirty, y=cum.ene.dirty, label=formatC(cum.ene.dirty, digits = 1, format="f")), size = 2.5, hjust=1) +
# geom_text(aes(x=cum.gdp.clean, y=cum.ene.clean, label=formatC(cum.ene.clean, digits = 1, format="f")), size = 2.5, hjust=1)
ggplot(cum.plot.data %>% arrange(tot.gdp.max.2050), aes(x=cum.gdp.max, y=cum.ene.max)) +
geom_step(aes(color="SSP4 (g=0.45, e=1.1)"), direction="vh") +
geom_text(data=cum.plot.data %>% filter(tot.gdp.max.2050>5), aes(label=iso3c), size = 2.5) +
geom_step(aes(x=cum.gdp.max.dirty, y=cum.ene.max.dirty, color="Dirty (g=0.3, e=1.1)"), direction="vh") +
geom_text(data=cum.plot.data %>% filter(tot.gdp.max.2050>5), aes(x=cum.gdp.max.dirty, y=cum.ene.max.dirty, label=iso3c), size = 2.5) +
geom_step(aes(x=cum.gdp.max.clean, y=cum.ene.max.clean, color="Clean (g=0.3, e=1.1)"), direction="vh") +
geom_text(data=cum.plot.data %>% filter(tot.gdp.max.2050>5), aes(x=cum.gdp.max.clean, y=cum.ene.max.clean, label=iso3c), size = 2.5) +
labs(y="Energy (kgoe)", x="Total GDP (trillion PPP$ 2005)") #+
# Step graphs comparing total energy (SSP2 vs SSP1/SSP4)
# Total GDP in trillion $
# Total energy in trillion kgoe
cum.plot.SSP <- ENE.yearly.adj %>% select(iso3c, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(int.base.SSP4=ene.base.SSP4/gdp.pcap.SSP4, int.base.SSP1=ene.base.SSP1/gdp.pcap.SSP1, int.base.SSP2=ene.base.SSP2/gdp.pcap.SSP2) %>%
arrange(int.base.SSP4) %>%
mutate(tot.gdp.SSP4=gdp.pcap.SSP4*pop.SSP4/1e12, cum.gdp.SSP4 = cumsum(tot.gdp.SSP4), cum.ene.SSP4 = cumsum(int.base.SSP4*tot.gdp.SSP4)) %>%
arrange(int.base.SSP1) %>%
mutate(tot.gdp.SSP1=gdp.pcap.SSP1*pop.SSP1/1e12, cum.gdp.SSP1 = cumsum(tot.gdp.SSP1), cum.ene.SSP1 = cumsum(int.base.SSP1*tot.gdp.SSP1)) %>%
arrange(int.base.SSP2) %>%
mutate(tot.gdp.SSP2=gdp.pcap.SSP2*pop.SSP2/1e12, cum.gdp.SSP2 = cumsum(tot.gdp.SSP2), cum.ene.SSP2 = cumsum(int.base.SSP2*tot.gdp.SSP2)) # GDP in trillion $2005
ggplot(cum.plot.SSP, aes(x=cum.gdp.SSP2, y=int.base.SSP2)) + geom_step(aes(color="SSP2 (g=0.36, e=0.89)")) +
geom_step(aes(x=cum.gdp.SSP4, y=int.base.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_step(aes(x=cum.gdp.SSP1, y=int.base.SSP1, color="SSP1 (g=0.3, e=0.89)")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(y="Energy intensity (kgoe/$)", x="Total GDP (trillion PPP$ 2005)") +
geom_text(aes(x=cum.gdp.SSP4, y=int.base.SSP4, label=formatC(cum.ene.SSP4, digits = 1, format="f")), size = 2.5, hjust=1) +
geom_text(aes(x=cum.gdp.SSP1, y=int.base.SSP1, label=formatC(cum.ene.SSP1, digits = 1, format="f")), size = 2.5, hjust=1)
a <- ENE.yearly.adj %>% select(iso3c, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4))
a <-   rbind(0,a)
ggplot(a, aes(x=1:dim(a)[1], y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy (kgoe)")
# geom_text(aes(x=cum.gdp.SSP4, y=int.base.SSP4, label=formatC(cum.ene.SSP4, digits = 1, format="f")), size = 2.5, hjust=1) +
# geom_text(aes(x=cum.gdp.SSP1, y=int.base.SSP1, label=formatC(cum.ene.SSP1, digits = 1, format="f")), size = 2.5, hjust=1)
ggplot(a, aes(x=1:dim(a)[1], y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP2-cum.ene.now, shape="2")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP4-cum.ene.now, shape="4")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy difference from now (kgoe)")
# Plot - Total energy per cap vs gdp/cap
# ggplot(ENE.yearly.adj %>% arrange(gdp) %>% mutate(num=1:length(gdp)), aes(x=num, y=ene)) + geom_point() +
#   geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
#   geom_point(aes(x=num, y=ene.adj.eq, color="Gini=0.3, elas=1")) +
#   geom_point(aes(x=num, y=ene.adj.eq.min, color="Gini=0.3, elas=worst"))
ggplot(ENE.yearly.adj %>% arrange(gdp) %>% mutate(num=1:length(gdp)), aes(x=gdp, y=ene)) + geom_point() +
geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
geom_line(aes(x=con.ppp, y=exp(eqn$coefficients[1])*con.ppp^(eqn$coefficients[2])))
n_group <- 10
clean.poor <- ENE.yearly.adj.ppp %>% filter(con.ppp < mean.exp - 1000) %>% arrange(inten.ppp) %>% slice(1:n_group)
dirty.poor <- ENE.yearly.adj.ppp %>% filter(con.ppp < mean.exp - 1000) %>% arrange(desc(inten.ppp)) %>% slice(1:n_group)
clean.rich <- ENE.yearly.adj.ppp %>% filter(con.ppp >= mean.exp + 1000) %>% arrange(inten.ppp) %>% slice(1:n_group)
dirty.rich <- ENE.yearly.adj.ppp %>% filter(con.ppp >= mean.exp + 1000) %>% arrange(desc(inten.ppp)) %>% slice(1:n_group)
tot.decrease <- as.numeric(ENE.yearly.adj.ppp %>% mutate(con.diff.total=(con.ppp-con.adj.eq.ppp)*pop) %>%
filter(con.diff.total>=0) %>% summarise(tot.decrease=sum(con.diff.total)))
ENE.yearly.adj.ppp.dirty <- dirty.poor %>% mutate(con.ppp.tot = con.ppp*pop) %>% mutate(con.ppp.inc = tot.decrease * con.ppp.tot / sum(con.ppp.tot) / pop) %>%
mutate(con.adj.eq.ppp=con.ppp+con.ppp.inc) %>% select(-con.ppp.tot, -con.ppp.inc) %>%
rbind(ENE.yearly.adj.ppp %>% filter(!iso2c %in% dirty.poor$iso2c) %>% mutate_cond(con.ppp < mean.exp, con.adj.eq.ppp=con.ppp))
ENE.yearly.adj.ppp.clean <- clean.poor %>% mutate(con.ppp.tot = con.ppp*pop) %>% mutate(con.ppp.inc = tot.decrease * con.ppp.tot / sum(con.ppp.tot) / pop) %>%
mutate(con.adj.eq.ppp=con.ppp+con.ppp.inc) %>% select(-con.ppp.tot, -con.ppp.inc) %>%
rbind(ENE.yearly.adj.ppp %>% filter(!iso2c %in% clean.poor$iso2c) %>% mutate_cond(con.ppp < mean.exp, con.adj.eq.ppp=con.ppp))
print(c(sum(ENE.yearly.adj.ppp.clean$con.adj.eq.ppp), sum(ENE.yearly.adj.ppp.dirty$con.adj.eq.ppp)))
# GDP difference between now and future
gdp.diff <- ENE.yearly.adj %>% select(iso3c, gdp, contains("pop."), contains("gdp.pcap")) %>% mutate_at(vars(contains("gdp.pcap")), funs(.-gdp))
gdp.diff <- gdp.diff %>% mutate_cond(gdp.pcap.SSP1 < 0, gdp.pcap.SSP1=0)
Lc(gdp.diff$gdp.pcap.SSP1, gdp.diff$pop.SSP1, plot=TRUE)
gini(ENE.yearly.adj$gdp.pcap.SSP1, ENE.yearly.adj$pop.SSP1)
gini(gdp.diff$gdp.pcap.SSP1, gdp.diff$pop.SSP1)
gini(ENE.yearly.adj$gdp.pcap.SSP2, ENE.yearly.adj$pop.SSP2)
gini(gdp.diff$gdp.pcap.SSP2, gdp.diff$pop.SSP2)
gini(ENE.yearly.adj$gdp.pcap.SSP4, ENE.yearly.adj$pop.SSP4)
gini(gdp.diff$gdp.pcap.SSP4, gdp.diff$pop.SSP4)
}
a <- ENE.yearly.adj %>% select(iso3c, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4))
a <-   rbind(0,a)
ggplot(a, aes(x=1:dim(a)[1], y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy (kgoe)")
ggplot(ENE.yearly.adj.clean, aes(x=gdp, y=ene/gdp)) + geom_point(aes(size=pop, alpha=.02)) +
geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
scale_size(range = c(1,10)) +
geom_point(aes(x=gdp.pcap.SSP4, y=ene.max.SSP4/gdp.pcap.SSP4, size=pop.SSP4, alpha=.02, color="SSP4 (e=1.1)")) +
geom_text(aes(x=gdp.pcap.SSP4, y=ene.max.SSP4/gdp.pcap.SSP4, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.clean, y=ene.max.clean/gdp.pcap.clean, size=pop.SSP4, alpha=.02, color="Clean (e=1.1)")) +
geom_text(aes(x=gdp.pcap.clean, y=ene.max.clean/gdp.pcap.clean, label=iso3c), size = 2.5, hjust=1) +
geom_point(data=ENE.yearly.adj.dirty, aes(x=gdp.pcap.dirty, y=ene.max.dirty/gdp.pcap.dirty, size=pop.SSP4, alpha=.02, color="Dirty (e=1.1)")) +
geom_text(data=ENE.yearly.adj.dirty, aes(x=gdp.pcap.dirty, y=ene.max.dirty/gdp.pcap.dirty, label=iso3c), size = 2.5, hjust=1) +
labs(title="Max elasticity = 1.1", x ="GDP/cap (PPP$ 2005)", y = "Energy intensity (kgoe/$)")
ggplot(ENE.yearly.adj %>% filter(pop>5e7), aes(x=gdp, y=inten.gdp)) +
# geom_point(aes(size=pop, alpha=.02, color="Base 2013")) +
scale_size(range = c(1,15)) +
# geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1/gdp.pcap.SSP1, size=pop.SSP1, alpha=.02, color="SSP1 2050")) +
geom_text(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1/gdp.pcap.SSP1, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP2, y=ene.base.SSP2/gdp.pcap.SSP2, size=pop.SSP2, alpha=.02, color="SSP2 2050")) +
geom_text(aes(x=gdp.pcap.SSP2, y=ene.base.SSP2/gdp.pcap.SSP2, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP4, y=ene.base.SSP4/gdp.pcap.SSP4, size=pop.SSP4, alpha=.02, color="SSP4 2050")) +
geom_text(aes(x=gdp.pcap.SSP4, y=ene.base.SSP4/gdp.pcap.SSP4, label=iso3c), size = 2.5, hjust=1) +
geom_line(aes(x=gdp, y=exp(eqn$coefficients[1])*gdp^(eqn$coefficients[2]-1))) +
labs(x="GDP per capita (in log)", y="Energy intensity (kgoe/$) (in log)") +
scale_alpha(guide = 'none') +
scale_x_log10() + scale_y_log10()
ggplot(ENE.yearly.adj %>% filter(pop>5e7), aes(x=gdp, y=ene*pop)) +
geom_point(aes(alpha=.02, color="Base 2013")) +
scale_size(range = c(1,15)) +
geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1*pop.SSP1, alpha=.02, color="SSP1 2050")) +
geom_text(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1*pop.SSP1, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP2, y=ene.base.SSP2*pop.SSP2, alpha=.02, color="SSP2 2050")) +
geom_text(aes(x=gdp.pcap.SSP2, y=ene.base.SSP2*pop.SSP2, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP4, y=ene.base.SSP4*pop.SSP4, alpha=.02, color="SSP4 2050")) +
geom_text(aes(x=gdp.pcap.SSP4, y=ene.base.SSP4*pop.SSP4, label=iso3c), size = 2.5, hjust=1) +
scale_alpha(guide = 'none') + labs(y="Total primary energy") +
scale_x_log10() #+ scale_y_log10()
cty.scenario <- ENE.yearly.adj %>%
rename(gdp.pcap.SSP0=gdp, pop.SSP0=pop, ene.base.SSP0=ene) %>%
select(iso3c, contains("pop"), contains("base"), contains("gdp.pcap"), contains("ene"), -inten.gdp) %>% gather(key=category, value=val, -iso3c)
cty.scenario <- cty.scenario %>% filter(!grepl("SSP3|SSP5|min|max", category)) %>% arrange(iso3c, category) %>%
tidyr::extract(category, c("category", "scenario"), "([a-z.]+).(SSP[0-9])") %>%
spread(category, val) #%>% mutate(gdp.tot=gdp.pcap*pop)
ggplot(cty.scenario %>% filter(scenario=="SSP2" | scenario=="SSP1"), aes(x=gdp.pcap, y=ene.base*pop, group = iso3c, color = iso3c)) +
geom_path(aes(alpha=.02), arrow = arrow(angle=12, type="closed", length=unit(0.25, "cm"))) +
# scale_size(range = c(1,15)) +
geom_text_repel(data=cty.scenario %>% filter(scenario=="SSP2"), aes(label=iso3c), size = 2.5) +
scale_alpha(guide = 'none')  + theme(legend.position="none") +
scale_x_log10()
ggplot(cty.scenario %>% filter(scenario!="SSP0"), aes(x=gdp.pcap, y=ene.base*pop, group = iso3c, color = iso3c)) +
geom_path(aes(alpha=.02), arrow = arrow(angle=12, type="closed", length=unit(0.25, "cm"))) +
# scale_size(range = c(1,15)) +
geom_text(data=cty.scenario %>% filter(scenario=="SSP2"), aes(label=iso3c), size = 2.5) +
scale_alpha(guide = 'none')  + theme(legend.position="none") + labs(y="Total energy") +
scale_x_log10()
ggplot(ENE.yearly.adj %>% filter(pop>5e7), aes(x=gdp, y=ene)) +
# geom_point(aes(size=pop, alpha=.02, color="Base 2013")) +
scale_size(range = c(1,15)) +
# geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1, size=pop.SSP1, alpha=.02, color="SSP1 2050")) +
geom_text(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP2, y=ene.base.SSP2, size=pop.SSP2, alpha=.02, color="SSP2 2050")) +
geom_text(aes(x=gdp.pcap.SSP2, y=ene.base.SSP2, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP4, y=ene.base.SSP4, size=pop.SSP4, alpha=.02, color="SSP4 2050")) +
geom_text(aes(x=gdp.pcap.SSP4, y=ene.base.SSP4, label=iso3c), size = 2.5, hjust=1) +
scale_alpha(guide = 'none') + labs(y="Energy per capita") +
scale_x_log10() + scale_y_log10()
m <- ggplot(ENE.yearly.adj, aes(x=gdp, y=inten.gdp)) + geom_point() +
geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP1, y=ene.base.SSP1/gdp.pcap.SSP1, color="measured elas")) +
geom_point(aes(x=gdp.pcap.SSP1, y=ene.min.SSP1/gdp.pcap.SSP1, color="min.elas = 0.7")) +
geom_point(aes(x=gdp.pcap.SSP1, y=ene.max.SSP1/gdp.pcap.SSP1, color="max.elas = 1.1")) +
geom_text(aes(x=gdp.pcap.SSP1, y=ene.max.SSP1/gdp.pcap.SSP1, label=iso3c), size = 2.5, hjust=1) +
labs(title="SSP1", x ="GDP/cap (PPP$ 2005)", y = "Energy intensity (kgoe/$)")
m + geom_line(aes(x=gdp, y=exp(eqn$coefficients[1])*gdp^(eqn$coefficients[2]-1)))
a <- ENE.yearly.adj %>% select(iso3c, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4))
a <- rbind(0,a)
ggplot(a, aes(x=1:dim(a)[1], y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy (kgoe)")
head(ENE.yearly.adj)
62239.729*9039978
62239.729*9039978/1e12
62239.729*9039978/1e9
a <- ENE.yearly.adj %>% select(iso3c, gdp, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
a <- rbind(0,a)
ggplot(a, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy (kgoe)")
ggplot(a, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="5")) +
geom_text(data=a %>% filter(gdp.SSP2>500), aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy (kgoe)")
ggplot(a, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="5")) +
geom_text(data=a %>% filter(gdp.SSP2>500), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP (b$)", y="Cumulative total energy (kgoe)")
ggplot(a, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="4")) +
geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="5")) +
geom_text_repel(data=a %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP (b$)", y="Cumulative total energy (kgoe)")
ggplot(a, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="SSP2")) +
geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="SSP4")) +
geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="2013")) +
geom_text_repel(data=a %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP (b$)", y="Cumulative total energy (kgoe)")
ggplot(a, aes(x=1:dim(a)[1], y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP2-cum.ene.now, shape="2")) +
geom_line(aes(x=1:dim(a)[1], y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=1:dim(a)[1], y=cum.ene.SSP4-cum.ene.now, shape="4")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy difference from now (kgoe)")
ggplot(a, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="4")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Country", y="Cumulative total energy difference from now (kgoe)")
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
ggplot(cum.tot, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="SSP2")) +
geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="SSP4")) +
geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="2013")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP (b$)", y="Cumulative total energy (kgoe)")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="4")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference (b$)", y="Cumulative total energy difference from 2013 (kgoe)")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="2")) +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="4")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference (b$)", y="Cumulative total energy difference from 2013 (kgoe)")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2")) +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference (b$)", y="Cumulative total energy difference from 2013 (kgoe)")
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4)
View(cum.tot)
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4,
intensity.SSP1.diff=(cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now),
intensity.SSP2=(cum.ene.SSP2-cum.ene.now)/(cum.gdp.SSP2-cum.gdp.now),
intensity.SSP4=(cum.ene.SSP4-cum.ene.now)/(cum.gdp.SSP4-cum.gdp.now))
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4,
intensity.SSP1.diff=(cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now),
intensity.SSP2.diff=(cum.ene.SSP2-cum.ene.now)/(cum.gdp.SSP2-cum.gdp.now),
intensity.SSP4.diff=(cum.ene.SSP4-cum.ene.now)/(cum.gdp.SSP4-cum.gdp.now))
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(color="pink",shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2", color="green")) +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4", color="blue")) +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=(cum.gdp.now/cum.gdp.SSP1)[dim(cum.tot)[2]]*(cum.gdp.SSP1-cum.gdp.now)))
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=(cum.gdp.now/cum.gdp.SSP1)[dim(cum.tot)[1]]*(cum.gdp.SSP1-cum.gdp.now)))
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=(cum.ene.SSP1/cum.gdp.SSP1)[dim(cum.tot)[1]]*(cum.gdp.SSP1-cum.gdp.now)))
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=((cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now))[dim(cum.tot)[1]]*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=((cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now))[dim(cum.tot)[1]]*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
ggplot(cum.tot %>% arrange(gdp.pcap.SSP2), aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=((cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now))[dim(cum.tot)[1]]*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop, tot.ene.SSP2=ene.base.SSP2*pop.SSP2, tot.ene.SSP1=ene.base.SSP1*pop.SSP1, tot.ene.SSP4=ene.base.SSP4*pop.SSP4) %>%
arrange(gdp.pcap.SSP2) %>% #arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1)/sum(tot.gdp.SSP1)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1)/sum(gdp.SSP1)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45, e=0.89)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)") +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
cum.plot.SSP <- ENE.yearly.adj %>% select(iso3c, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(int.base.SSP4=ene.base.SSP4/gdp.pcap.SSP4, int.base.SSP1=ene.base.SSP1/gdp.pcap.SSP1, int.base.SSP2=ene.base.SSP2/gdp.pcap.SSP2) %>%
arrange(int.base.SSP4) %>%
mutate(tot.gdp.SSP4=gdp.pcap.SSP4*pop.SSP4/1e12, cum.gdp.SSP4 = cumsum(tot.gdp.SSP4), cum.ene.SSP4 = cumsum(int.base.SSP4*tot.gdp.SSP4)) %>%
arrange(int.base.SSP1) %>%
mutate(tot.gdp.SSP1=gdp.pcap.SSP1*pop.SSP1/1e12, cum.gdp.SSP1 = cumsum(tot.gdp.SSP1), cum.ene.SSP1 = cumsum(int.base.SSP1*tot.gdp.SSP1)) %>%
arrange(int.base.SSP2) %>%
mutate(tot.gdp.SSP2=gdp.pcap.SSP2*pop.SSP2/1e12, cum.gdp.SSP2 = cumsum(tot.gdp.SSP2), cum.ene.SSP2 = cumsum(int.base.SSP2*tot.gdp.SSP2)) # GDP in trillion $2005
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4,
intensity.SSP1.diff=(cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now),
intensity.SSP2.diff=(cum.ene.SSP2-cum.ene.now)/(cum.gdp.SSP2-cum.gdp.now),
intensity.SSP4.diff=(cum.ene.SSP4-cum.ene.now)/(cum.gdp.SSP4-cum.gdp.now))
ggplot(CON.ENE.PCAP %>% arrange(iso3c, year), aes(x=gdp, y=inten.gdp, group = iso3c, color=iso3c)) +
geom_path(alpha=0.5, arrow = arrow(angle=30, type="closed", length=unit(0.25, "cm"))) +
geom_text_repel(data=CON.ENE.PCAP %>% filter(year==2013), aes(label=iso3c)) + theme(legend.position="none") +
scale_x_log10() + scale_y_log10()
ggplot(CON.ENE.PCAP %>% arrange(iso3c, year), aes(x=gdp, y=inten.gdp, group = iso3c, color=iso3c)) +
geom_path(alpha=0.5, arrow = arrow(angle=30, type="closed", length=unit(0.25, "cm"))) +
geom_text_repel(data=CON.ENE.PCAP %>% filter(year==2013), aes(label=iso3c)) + theme(legend.position="none") #+
ssp.gdp.ppp
colSums(ssp.gdp.ppp[,-1])
str(ENE.yearly)
(ENE.yearly) %>% arrange(gdp.pcap.SSP1 )
(ENE.yearly) %>% arrange(desc(gdp.pcap.SSP1 ))
