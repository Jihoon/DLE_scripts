list.select(DLE.input, TFEI)
rm(TFEI)
list.select(DLE.input, TFEI)
list.select(DLE.input, TFEI$Clothing)
list.select(DLE.input$IND, TFEI$Clothing)
list.select(DLE.input$IND, pop)
list.select(DLE.input$IND, use.pcap)
class(DLE>input$IND)
class(DLE.input$IND)
list.tree(DLE.input$IND)
list.select(DLE.input$IND, use.pcap$year)
list.select(DLE.input$IND,
list.select(x, type, score.range = range(unlist(score)))use.pcap$year)
list.select(x, type, score.range = range(unlist(score)))
list.select(DLE.input, sc.DLE.BAU$use.pcap$year)
list.select(DLE.input, sc.BAU$use.pcap$year)
list.select(DLE.input$IND, sc.BAU$use.pcap$year)
list.select(DLE.input$IND, $use.pcap$year)
list.select(DLE.input$IND, use.pcap$year)
?list.update()
list.update(DLE.input, sc.GDP$use.pcap$Clothing=1:5)
list.select(DLE.input, sc.GDP$use.pcap$Clothing)
DLE.input$IND
df.dummy <- data.frame(year=Year.obs, setNames(data.frame(matrix(ncol = length(DLE.sectors), nrow = length(Year.obs))), DLE.sectors))
df.unit <- list(TFEI=df.dummy, use.pcap=df.dummy)
df.cty <- list(sc.GDP=df.unit, sc.DLE.base=df.unit, sc.DLE.LCT=df.unit, sc.DLE.LCTBHV=df.unit, sc.BAU=df.unit)
DLE.input <- list(IND=df.cty, BRA=df.cty, ZAF=df.cty)
list.select(DLE.input$IND, use.pcap$Clothing)
list.select(DLE.input, use.pcap$Clothing)
DLE.param <- list(IND=list(pop=Year.obs, gdp=Year.obs),
BRA=list(pop=Year.obs, gdp=Year.obs),
ZAF=list(pop=Year.obs, gdp=Year.obs))
DLE.scenario <- list(IND=df.cty, BRA=df.cty, ZAF=df.cty)
clothing.pcap.IND
clothing.pcap.BRA
clothing.pcap.BRA <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing)
clothing.pcap.BRA
clothing.pcap.ZAF
clothing.pcap.ZAF <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing)
val_tot=sum(val_tot*weight, na.rm=TRUE)
clothing.pcap.ZAF
footwear.pcap.ZAF <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>% select(kg.pcap)
clothing.pcap.ZAF <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>% select(kg.pcap)
clothing.pcap.ZAF <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
clothing.pcap.BRA <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
footwear.pcap.BRA <- BRA_footwear %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
clothing.pcap.ZAF <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
footwear.pcap.ZAF <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
clothing.pcap.IND
clothing.pcap.IND <- clothing.all %>% summarise(median = weighted.median(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric() # 1.3 kg/cap
footwear.pcap.IND <- footwear.all %>% summarise(median = weighted.median(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric()  # 0.9 kg/cap
list.update(DLE.scenario$IND, use.pcap$Clothing=clothing.pcap.IND)
list.select(DLE.scenario$IND, use.pcap$Clothing)
list.update(DLE.scenario$IND, use.pcap$Clothing=clothing.pcap.IND)
list.select(DLE.scenario$IND, use.pcap$Clothing)
list.update(DLE.scenario$IND, use.pcap$Clothing=1:5)
x
list.update(x, score=list(min=0, max=10))
list.select(DLE.scenario$IND, use.pcap$Clothing)
list.update(DLE.scenario$IND, use.pcap$Clothing=clothing.pcap.IND)
df.dummy
DLE.sectors[,
"Clothing"]
df.dummy[,
"Clothing"]
df.dummy[, DLE.sectors]
df.dummy[, match(DLE.sectors, names(df.dummy))]
match(DLE.sectors, names(df.dummy))
DLE.sectors
names(df.dummy)
match(c("Food", "Clothing"), names(df.dummy))
list.extract()
?list.extract()
x <- list(a=1, b=2, c=3)
list.extract(x, 1)
list.extract(DLE.scenario, c(1,2))
list.extract(DLE.scenario, c(1))
list.extract(DLE.scenario, 2)
DLE.scenario[[1:2]]
DLE.scenario[[2]]
str(DLE.scenario)
list.extract(DLE.scenario$IND, 2)
list.extract(DLE.scenario$IND, 1)
list.extract(DLE.scenario$IND, 1:@)
list.extract(DLE.scenario$IND, 1:2)
DLE.scenario$IND[[1]]
DLE.scenario$IND
list.tree(DLE.scenario$IND)
DLE.scenario$IND[[c(1,3)]]
x <- list(a=1, b=2, c=3)
list.extract(x, 1:2)
x <- list(a=1, b=2, c=3)
list.extract(x, 1)
x <- list(a=1, b=2, c=3)
list.extract(x, 2)
x <- list(a=7, b=4, c=3)
list.extract(x, 2)
x <- list(a=7, b=4, c=3)
list.extract(x, 1)
x <- list(a=7, b=4, c=3)
list.extract(x, c(1, 2)
)
x <- list(a=7, b=4, c=3)
list.extractx <- list(a=1, b=2, c=3)
subset(x, c(1, 2))
x <- list(a=7, b=4, c=3)
list.extractx <- list(a=1, b=2, c=3)
subset(x, select=c("a", "b"))
x
x <- list(p1 = list(type='A',score=list(c1=10,c2=8)),
p2 = list(type='B',score=list(c1=9,c2=9)),
p3 = list(type='B',score=list(c1=9,c2=7)))
subset(x, select = score)
updateDLEscenario.use <- function(scenarios="All", sect=DLE.sectors, val) {
lapply(DLE.scenario, function(x) {
if(scenarios=="All") lapply(x, function(sc) {sc$use.pcap[, match(sect, names(sc$use.pcap))] <- val})
else {
match(scenarios, names(x))
}
})
}
updateDLEscenario.use(sect=Clothing, 1:5)
updateDLEscenario.use <- function(scenarios="All", sect=DLE.sectors, val) {
lapply(DLE.scenario, function(cty) {
if(scenarios=="All") lapply(cty, function(sc) {sc$use.pcap[, match(sect, names(sc$use.pcap))] <- val})
else {
match(scenarios, names(cty))
}
})
}
updateDLEscenario.use(sect=Clothing, 1:5)
list.select(DLE.scenario$IND, use.pcap$Clothing)
match("Clothing", names(DLE.scenario$IND$sc.GDP$use.pcap))
updateDLEscenario.use(sect=Clothing, clothing.pcap.IND)
list.select(DLE.scenario$IND, use.pcap$Clothing)
debug(updateDLEscenario.use)
list.select(DLE.scenario$IND, use.pcap$Clothing)
updateDLEscenario.use(sect=Clothing, clothing.pcap.IND)
updateDLEscenario.use(sect=Clothing, clothing.pcap.IND)
list.select(DLE.scenario$IND, use.pcap$Clothing)
list.update(DLE.scenario$IND, use.pcap$Clothing=1:5)
?list.update
substitute(mean(exp(sqrt(.)), .))
?quote
convert.call <- function(x, replacement) {
if (is.call(x)) as.call(lapply(x, convert.call, replacement=replacement)) else
if (identical(x, quote(.))) as.name(replacement) else
x
}
convert.call(expr, "x")
expr <- substitute(mean(exp(sqrt(.)), .))
convert.call <- function(x, replacement) {
if (is.call(x)) as.call(lapply(x, convert.call, replacement=replacement)) else
if (identical(x, quote(.))) as.name(replacement) else
x
}
convert.call(expr, "x")
expr
class(exp())
class(expr
)
expr[[1]]
expr[[2]]
expr[[3]]
?seq
1*2^(1:5)
geoSeq <- function(base, r, n) {
return(base * r^(1:n))
}
tot.clothing.IND * geoSeq(1, r=1.1, length(Year.obs))
tot.clothing.IND
hist(tot.clothing.IND)
df.dummy <- data.frame(year=Year.obs, setNames(data.frame(matrix(ncol = length(DLE.sectors), nrow = length(Year.obs))), DLE.sectors))
df.unit <- list(TFEI=df.dummy, use.pcap=df.dummy, E.tot=df.dummy)
df.cty <- list(sc.GDP=df.unit, sc.DLE.base=df.unit, sc.DLE.LCT=df.unit, sc.DLE.LCTBHV=df.unit, sc.BAU=df.unit)
DLE.scenario <- list(IND=df.cty, BRA=df.cty, ZAF=df.cty)
DLE.param <- list(IND=list(pop=Year.obs, gdp=Year.obs),
BRA=list(pop=Year.obs, gdp=Year.obs),
ZAF=list(pop=Year.obs, gdp=Year.obs))
DLE.scenario$IND$sc.GDP$E.tot$Clothing <- mean(tot.clothing.IND) * geoSeq(1, r=1.1, length(Year.obs))
DLE.scenario$IND$sc.GDP$E.tot$Clothing
DLE.scenario$IND$sc.GDP$E.tot$Clothing <- mean(tot.clothing.IND) * geoSeq(1, r=1.05, length(Year.obs))
geoSeq <- function(base, r, n) {
return(base * (1+r)^(1:n))
}
DLE.scenario$IND$sc.GDP$E.tot$Clothing <- mean(tot.clothing.IND) * geoSeq(1, r=0.05, length(Year.obs))
<- mean(tot.clothing.IND) * geoSeq(1, r=0.05, length(Year.obs))
DLE.scenario$IND$sc.GDP$E.tot$Clothing
DLE.scenario$BRA$sc.GDP$E.tot$Clothing <- mean(tot.clothing.BRA) * geoSeq(1, r=0.05, length(Year.obs))
DLE.scenario$ZAF$sc.GDP$E.tot$Clothing <- mean(tot.clothing.ZAF) * geoSeq(1, r=0.05, length(Year.obs))
avg.clothing.pcap.IND <- clothing.all %>% summarise(median = weighted.mean(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric() # 1.3 kg/cap
avg.footwear.pcap.IND <- footwear.all %>% summarise(median = weighted.mean(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric()  # 0.9 kg/cap
clothing.pcap.IND
footwear.pcap.IND
library(plotrix)
weighted.hist(clothing.all %>% )
head(clothing.all )
clothing.all %>% weighted.hist(hh_size, weight)
weighted.hist(clothing.all$weight.tot/clothing.all$hh_size, clothing.all$weight)
clothing.all$weight.tot/clothing.all$hh_size
weighted.hist(clothing.all$weight.tot/clothing.all$hh_size, clothing.all$weight)
weighted.hist(x=clothing.all$weight.tot/clothing.all$hh_size, w=clothing.all$weight)
class(clothing.all$weight.tot/clothing.all$hh_size)
is.numeric(clothing.all$weight.tot/clothing.all$hh_size)
ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE))
rowSums(BRA_intensity[, idx.clothing.icp] %*% diag(BRA_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
rowSums(BRA_intensity.use[, idx.clothing.icp] %*% diag(BRA_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.clothing.BRA <- rowSums(BRA_intensity.use[, idx.clothing.icp] %*% diag(BRA_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.clothing.ZAF <- rowSums(ZAF_intensity.use[, idx.clothing.icp] %*% diag(ZAF_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.clothing.IND <- rowSums(IND_intensity.use[, idx.clothing.icp] %*% diag(IND_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
DLE.scenario$IND$sc.GDP$E.tot$Clothing <- mean(tot.clothing.IND) * geoSeq(1, r=0.05, length(Year.obs))
DLE.scenario$BRA$sc.GDP$E.tot$Clothing <- mean(tot.clothing.BRA) * geoSeq(1, r=0.05, length(Year.obs))
DLE.scenario$ZAF$sc.GDP$E.tot$Clothing <- mean(tot.clothing.ZAF) * geoSeq(1, r=0.05, length(Year.obs))
DLE.scenario$BRA$sc.GDP$E.tot$Clothing
DLE.scenario$ZAF$sc.GDP$E.tot$Clothing
DLE.scenario$IND$sc.GDP$E.tot$Clothing
ICP_catnames[idx.clothing.icp]
idx.clothing.icp <- c(50, 51)  # 50:55
idx.footwear.icp <- 54  # 50:55
tot.clothing.BRA <- rowSums(BRA_intensity.use[, idx.clothing.icp] %*% diag(BRA_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.clothing.IND <- rowSums(IND_intensity.use[, idx.clothing.icp] %*% diag(IND_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.clothing.ZAF <- rowSums(ZAF_intensity.use[, idx.clothing.icp] %*% diag(ZAF_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.footwear.BRA <- rowSums(BRA_intensity.use[, idx.footwear.icp] %*% diag(BRA_FD_ICP_usd2007[idx.footwear.icp, 1])) / 1e6
tot.footwear.ZAF <- rowSums(ZAF_intensity.use[, idx.footwear.icp] %*% diag(ZAF_FD_ICP_usd2007[idx.footwear.icp, 1])) / 1e6
tot.footwear.IND <- rowSums(IND_intensity.use[, idx.footwear.icp] %*% diag(IND_FD_ICP_usd2007[idx.footwear.icp, 1])) / 1e6
data.frame
?data.frame
tot.footwear.BRA <- rowSums(BRA_intensity.use[, idx.footwear.icp, drop=FALSE] %*% diag(BRA_FD_ICP_usd2007[idx.footwear.icp, 1])) / 1e6
tot.footwear.IND <- rowSums(IND_intensity.use[, idx.footwear.icp, drop=FALSE] %*% diag(IND_FD_ICP_usd2007[idx.footwear.icp, 1])) / 1e6
tot.footwear.ZAF <- rowSums(ZAF_intensity.use[, idx.footwear.icp, drop=FALSE] %*% diag(ZAF_FD_ICP_usd2007[idx.footwear.icp, 1])) / 1e6
BRA_intensity.use[, idx.footwear.icp, drop=FALSE]
dim(BRA_intensity.use[, idx.footwear.icp, drop=FALSE])
dim(ZAF_intensity.use[, idx.clothing.icp])
diag(BRA_FD_ICP_usd2007[idx.footwear.icp, 1])
dim(diag(BRA_FD_ICP_usd2007[idx.footwear.icp, 1]))
diag(2)
?diag
diag(6)
tot.footwear.ZAF <- rowSums(ZAF_intensity.use[, idx.footwear.icp] * ZAF_FD_ICP_usd2007[idx.footwear.icp, 1]) / 1e6
tot.footwear.BRA <- (BRA_intensity.use[, idx.footwear.icp] * BRA_FD_ICP_usd2007[idx.footwear.icp, 1]) / 1e6
tot.footwear.IND <- (IND_intensity.use[, idx.footwear.icp] * IND_FD_ICP_usd2007[idx.footwear.icp, 1]) / 1e6
tot.footwear.ZAF <- (ZAF_intensity.use[, idx.footwear.icp] * ZAF_FD_ICP_usd2007[idx.footwear.icp, 1]) / 1e6
tot.footwear.BRA
tot.clothing.BRA
ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_median=weighted.median(val_tot, weight, na.rm=TRUE))
ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE))
ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing)
dle.clothing.pcap.ZAF <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.clothing.pcap.ZAF <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
dle.footwear.pcap.ZAF <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.ZAF
avg.footwear.pcap.ZAF <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.ZAF
avg.footwear.pcap.ZAF <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.ZAF <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid")) %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_mean/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
dle.footwear.pcap.ZAF
hist(clothing.all$val_tot)
scatter(clothing.all$decile, clothing.all$val_tot)
scatterplot(clothing.all$decile, clothing.all$val_tot)
scatterplot(ZAF_clothing.all$decile, ZAF_clothing.all$val_tot)
ZAF_clothing.all <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid"))
ZAF_footwear.all <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid"))
scatterplot(ZAF_clothing.all$decile, ZAF_clothing.all$val_tot)
BRA_clothing.all <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid"))
BRA_footwear.all <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid"))
dle.clothing.pcap.BRA <- BRA_clothing.all %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
dle.footwear.pcap.BRA <- BRA_footwear.all %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
ZAF_footwear.all <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid"))
ZAF_clothing.all <- ZAF_clothing %>% left_join(ZAF_HH, by = c("id" = "hhid"))
ZAF_footwear.all <- ZAF_footwear %>% left_join(ZAF_HH, by = c("id" = "hhid"))
dle.clothing.pcap.ZAF <- ZAF_clothing.all %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
dle.footwear.pcap.ZAF <- ZAF_footwear.all %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.clothing.pcap.ZAF <- ZAF_clothing.all %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.ZAF <- ZAF_footwear.all %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.ZAF <- ZAF_footwear.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_mean/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
### BRA
BRA_clothing.all <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid"))
BRA_footwear.all <- BRA_footwear %>% left_join(BRA_HH, by = c("id" = "hhid"))
dle.clothing.pcap.BRA <- BRA_clothing.all %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
dle.footwear.pcap.BRA <- BRA_footwear.all %>%
summarise(val_median=weighted.median(val_tot/hh_size, weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_median/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.clothing.pcap.BRA <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.BRA <- BRA_footwear %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
dle.clothing.pcap.BRA
avg.clothing.pcap.BRA
dle.footwear.pcap.BRA
avg.footwear.pcap.BRA
DLE.scenario$IND$sc.BAU$E.tot$Clothing <- mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND +
mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND
DLE.scenario$BRA$sc.BAU$E.tot$Clothing <- mean(tot.clothing.BRA) * dle.clothing.pcap.BRA / avg.clothing.pcap.BRA +
mean(tot.footwear.BRA) * dle.footwear.pcap.BRA / avg.footwear.pcap.BRA
DLE.scenario$ZAF$sc.BAU$E.tot$Clothing <- mean(tot.clothing.ZAF) * dle.clothing.pcap.ZAF / avg.clothing.pcap.ZAF +
mean(tot.footwear.ZAF) * dle.footwear.pcap.ZAF / avg.footwear.pcap.ZAF
dle.clothing.pcap.IND <- clothing.all %>% summarise(median = weighted.median(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric() # 1.3 kg/cap
dle.footwear.pcap.IND <- footwear.all %>% summarise(median = weighted.median(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric()  # 0.9 kg/cap
avg.clothing.pcap.IND <- clothing.all %>% summarise(median = weighted.mean(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric() # 1.3 kg/cap
avg.footwear.pcap.IND <- footwear.all %>% summarise(median = weighted.mean(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric()  # 0.9 kg/cap
kg.pcap.dec
dle.clothing.pcap.IND
dle.clothing.pcap.ZAF
BRA_clothing.all
dle.clothing.pcap.BRA
ZAF_clothing.all
dle.footwear.pcap.ZAF
dle.clothing.pcap.ZAF
ZAF_clothing.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
ZAF_clothing.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
BRA_clothing.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
BRA_footwear.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
avg.clothing.pcap.IND <- clothing.all %>% summarise(median = weighted.mean(val_tot/hh_size, weight, na.rm=TRUE)) %>% as.numeric() # 1.3 kg/cap
avg.footwear.pcap.IND <- footwear.all %>% summarise(median = weighted.mean(val_tot/hh_size, weight, na.rm=TRUE)) %>% as.numeric()  # 0.9 kg/cap
avg.clothing.pcap.IND
avg.footwear.pcap.IND
avg.clothing.pcap.ZAF
avg.clothing.pcap.ZAF <- ZAF_clothing.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
avg.footwear.pcap.ZAF <- ZAF_footwear.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
avg.clothing.pcap.ZAF
avg.footwear.pcap.ZAF
avg.clothing.pcap.BRA
avg.clothing.pcap.BRA <- BRA_clothing.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
avg.footwear.pcap.BRA <- BRA_footwear.all %>%
summarise(val_mean=weighted.mean(val_tot/hh_size, weight, na.rm=TRUE))
avg.clothing.pcap.BRA
avg.footwear.pcap.BRA
dim(IND_FD_ICP_usd2007)
(IND_FD_ICP_usd2007)[idx.clothing.icp]
(IND_FD_ICP_usd2007)[idx.clothing.icp,]
(IND_FD_ICP_usd2007)[idx.footwear.icp,]
(BRA_FD_ICP_usd2007)[idx.clothing.icp,]
(BRA_FD_ICP_usd2007)[idx.footwear.icp,]
(ZAF_FD_ICP_usd2007)[idx.footwear.icp,]
(ZAF_FD_ICP_usd2007)[idx.clothing.icp,]
DLE.scenario$IND$sc.BAU$E.tot$Clothing
DLE.scenario$IND$sc.BAU$E.tot$Clothing <- mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND +
mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND
DLE.scenario$BRA$sc.BAU$E.tot$Clothing <- mean(tot.clothing.BRA) * dle.clothing.pcap.BRA / avg.clothing.pcap.BRA +
mean(tot.footwear.BRA) * dle.footwear.pcap.BRA / avg.footwear.pcap.BRA
DLE.scenario$ZAF$sc.BAU$E.tot$Clothing <- mean(tot.clothing.ZAF) * dle.clothing.pcap.ZAF / avg.clothing.pcap.ZAF +
mean(tot.footwear.ZAF) * dle.footwear.pcap.ZAF / avg.footwear.pcap.ZAF
avg.clothing.pcap.IND <- clothing.all %>% summarise(mean = weighted.mean(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric() # 1.3 kg/cap
avg.footwear.pcap.IND <- footwear.all %>% summarise(mean = weighted.mean(weight.tot/hh_size, weight, na.rm=TRUE)/1000) %>% as.numeric()  # 0.9 kg/cap
avg.clothing.pcap.ZAF <- ZAF_clothing.all %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.ZAF <- ZAF_footwear.all %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/ZAF_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.clothing.pcap.BRA <- BRA_clothing %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
avg.footwear.pcap.BRA <- BRA_footwear %>% left_join(BRA_HH, by = c("id" = "hhid")) %>%
summarise(val_tot=sum(val_tot*weight, na.rm=TRUE)) %>% mutate(kg.pcap=val_tot/BRA_pop_2007/avg.price.clothing) %>%
select(kg.pcap) %>% as.numeric()
DLE.scenario$IND$sc.BAU$E.tot$Clothing <- mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND +
mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND
DLE.scenario$BRA$sc.BAU$E.tot$Clothing <- mean(tot.clothing.BRA) * dle.clothing.pcap.BRA / avg.clothing.pcap.BRA +
mean(tot.footwear.BRA) * dle.footwear.pcap.BRA / avg.footwear.pcap.BRA
DLE.scenario$ZAF$sc.BAU$E.tot$Clothing <- mean(tot.clothing.ZAF) * dle.clothing.pcap.ZAF / avg.clothing.pcap.ZAF +
mean(tot.footwear.ZAF) * dle.footwear.pcap.ZAF / avg.footwear.pcap.ZAF
DLE.scenario$IND$sc.BAU$E.tot$Clothing
DLE.scenario$BRA$sc.BAU$E.tot$Clothing
DLE.scenario$ZAF$sc.BAU$E.tot$Clothing
mean(tot.clothing.ZAF)
mean(tot.clothing.BRA)
mean(tot.clothing.IND)
tot.clothing.ZAF <- rowSums(ZAF_intensity.use[, idx.clothing.icp] %*% diag(ZAF_FD_ICP_usd2007[idx.clothing.icp, 1])) / 1e6
tot.clothing.ZAF
tot.footwear.ZAF <- (ZAF_intensity.use[, idx.footwear.icp] * ZAF_FD_ICP_usd2007[idx.footwear.icp, 1]) / 1e6
tot.footwear.ZAF
tot.clothing.ZAF
dle.footwear.pcap.ZAF / avg.footwear.pcap.ZAF
dle.clothing.pcap.ZAF / avg.clothing.pcap.ZAF
dle.clothing.pcap.BRA / avg.clothing.pcap.BRA
dle.clothing.pcap.IND / avg.clothing.pcap.IND
mylist_ <- list()
for(i in 1:5) {
for(j in 1:5) {
mylist[[j]] <- i*j
}
mylist_[[i]] <- mylist
}
mylist <- list()
mylist_ <- list()
for(i in 1:5) {
for(j in 1:5) {
mylist[[j]] <- i*j
}
mylist_[[i]] <- mylist
}
str(mylist_)
mylist_
idx.food.icp <- 1:45
list[all_HH_f_BR, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'BRA', BRA_FD_ICP_HH_adj_BR, BRA_intensity.use) # more reliable than IND_intensity
list[all_HH_f_BR, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'BRA', BRA_FD_ICP_AllHH, BRA_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd)
(SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) /1e6 # [EJ]
load(file="H:/MyDocuments/IO work/DLE_scripts/Saved tables/BRA_FD_ICP_HH_adj_BR.Rda")
load(file="H:/MyDocuments/IO work/DLE_scripts/Saved tables/IND_FD_ICP_HH_adj.Rda")
load(file="H:/MyDocuments/IO work/DLE_scripts/Saved tables/ZAF_FD_ICP_HH_adj.Rda")
list[all_HH_f_BR, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'BRA', BRA_FD_ICP_HH_adj_BR, BRA_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_BR, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'BRA', BRA_FD_ICP_AllHH, BRA_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_IN, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'IND', IND_FD_ICP_HH_adj, IND_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_IN) * as.numeric(IND_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_IN, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'IND', IND_FD_ICP_AllHH, IND_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_IN) * as.numeric(IND_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_ZA, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'ZAF', ZAF_FD_ICP_HH_adj, ZAF_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_ZA) * as.numeric(ZAF_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_ZA, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'ZAF', ZAF_FD_ICP_AllHH, ZAF_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_ZA) * as.numeric(ZAF_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
source('H:/MyDocuments/IO work/DLE_scripts/Load_init_data.R', echo=TRUE)
list[all_HH_f_BR, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'BRA', BRA_FD_ICP_HH_adj_BR, BRA_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_BR, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'BRA', BRA_FD_ICP_AllHH, BRA_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_IN, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'IND', IND_FD_ICP_HH_adj, IND_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_IN) * as.numeric(IND_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_IN, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'IND', IND_FD_ICP_AllHH, IND_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_IN) * as.numeric(IND_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_ZA, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'ZAF', ZAF_FD_ICP_HH_adj, ZAF_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_ZA) * as.numeric(ZAF_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
list[all_HH_f_ZA, sd_hs] <- GetHHSectoralEnergyPerCap(ICP_food_idx,'ZAF', ZAF_FD_ICP_AllHH, ZAF_intensity.use) # more reliable than IND_intensity
(SummarizeGJPerCap(all_HH_f_ZA) * as.numeric(ZAF_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
dim(ZAF_FD_ICP_HH_adj)
dim(ZAF_FD_ICP_AllHH)
a <- (SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
a
a <- (SummarizeGJPerCap(all_HH_f_ZA) * as.numeric(ZAF_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
tot.ENE.food.ZAF <- a$u
a <- (SummarizeGJPerCap(all_HH_f_IN) * as.numeric(IND_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
tot.ENE.food.IND <- a$u
tot.ENE.food.BRA
tot.ENE.food.IND
tot.ENE.food.ZAF
a <- (SummarizeGJPerCap(all_HH_f_BR) * as.numeric(BRA_pop_2007)) %>% mutate(min=u-2*sd, max=u+2*sd) / 1e9 # [EJ]
tot.ENE.food.BRA <- a$u
tot.ENE.food.BRA
mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND +
mean(tot.clothing.IND) * dle.clothing.pcap.IND / avg.clothing.pcap.IND
DLE.scenario$IND$sc.BAU$E.tot$Clothing
DLE.scenario$IND$sc.BAU$TFEI
BRA_pop_2007
DLE.scenario$IND$sc.BAU$TFEI$Food <- tot.ENE.food.IND / IND_pop_2007
DLE.scenario$BRA$sc.BAU$TFEI$Food <- tot.ENE.food.BRA / BRA_pop_2007
DLE.scenario$ZAF$sc.BAU$TFEI$Food <- tot.ENE.food.ZAF / ZAF_pop_2007
DLE.scenario$IND$sc.BAU$TFEI
DLE.scenario$BRA$sc.BAU$TFEI
DLE.scenario$ZAF$sc.BAU$TFEI
rm(all_HH_f_BR, all_HH_f_IN, all_HH_f_ZA)
gc()
lsos(n=20)
rm(L_inverse, tot_use)
gc()
