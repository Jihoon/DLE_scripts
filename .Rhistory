geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
print(cum.tot %>% select(starts_with("intensity.") %>% slice(n()))
# Plot - Total energy per cap vs gdp/cap
# ggplot(ENE.yearly.adj %>% arrange(gdp) %>% mutate(num=1:length(gdp)), aes(x=num, y=ene)) + geom_point() +
#   geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
#   geom_point(aes(x=num, y=ene.adj.eq, color="Gini=0.3, elas=1")) +
#   geom_point(aes(x=num, y=ene.adj.eq.min, color="Gini=0.3, elas=worst"))
ggplot(ENE.yearly.adj %>% arrange(gdp.pcap) %>% mutate(num=1:length(gdp.pcap)), aes(x=gdp.pcap, y=ene)) + geom_point() +
geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
geom_line(aes(x=con.ppp, y=exp(eqn$coefficients[1])*con.ppp^(eqn$coefficients[2])))
n_group <- 10
clean.poor <- ENE.yearly.adj.ppp %>% filter(con.ppp < mean.exp - 1000) %>% arrange(inten.ppp) %>% slice(1:n_group)
dirty.poor <- ENE.yearly.adj.ppp %>% filter(con.ppp < mean.exp - 1000) %>% arrange(desc(inten.ppp)) %>% slice(1:n_group)
clean.rich <- ENE.yearly.adj.ppp %>% filter(con.ppp >= mean.exp + 1000) %>% arrange(inten.ppp) %>% slice(1:n_group)
dirty.rich <- ENE.yearly.adj.ppp %>% filter(con.ppp >= mean.exp + 1000) %>% arrange(desc(inten.ppp)) %>% slice(1:n_group)
tot.decrease <- as.numeric(ENE.yearly.adj.ppp %>% mutate(con.diff.total=(con.ppp-con.adj.eq.ppp)*pop) %>%
filter(con.diff.total>=0) %>% summarise(tot.decrease=sum(con.diff.total)))
ENE.yearly.adj.ppp.dirty <- dirty.poor %>% mutate(con.ppp.tot = con.ppp*pop) %>% mutate(con.ppp.inc = tot.decrease * con.ppp.tot / sum(con.ppp.tot) / pop) %>%
mutate(con.adj.eq.ppp=con.ppp+con.ppp.inc) %>% select(-con.ppp.tot, -con.ppp.inc) %>%
rbind(ENE.yearly.adj.ppp %>% filter(!iso2c %in% dirty.poor$iso2c) %>% mutate_cond(con.ppp < mean.exp, con.adj.eq.ppp=con.ppp))
ENE.yearly.adj.ppp.clean <- clean.poor %>% mutate(con.ppp.tot = con.ppp*pop) %>% mutate(con.ppp.inc = tot.decrease * con.ppp.tot / sum(con.ppp.tot) / pop) %>%
mutate(con.adj.eq.ppp=con.ppp+con.ppp.inc) %>% select(-con.ppp.tot, -con.ppp.inc) %>%
rbind(ENE.yearly.adj.ppp %>% filter(!iso2c %in% clean.poor$iso2c) %>% mutate_cond(con.ppp < mean.exp, con.adj.eq.ppp=con.ppp))
print(c(sum(ENE.yearly.adj.ppp.clean$con.adj.eq.ppp), sum(ENE.yearly.adj.ppp.dirty$con.adj.eq.ppp)))
# GDP difference between now and future
gdp.diff <- ENE.yearly.adj %>% select(iso3c, contains("pop."), contains("gdp.pcap")) %>% mutate_at(vars(contains("gdp.pcap")), funs(.-gdp.pcap))
gdp.diff <- gdp.diff %>% mutate_cond(gdp.pcap.SSP1 < 0, gdp.pcap.SSP1=0)
Lc(gdp.diff$gdp.pcap.SSP1, gdp.diff$pop.SSP1, plot=TRUE)
gini(ENE.yearly.adj$gdp.pcap.SSP1, ENE.yearly.adj$pop.SSP1)
gini(gdp.diff$gdp.pcap.SSP1, gdp.diff$pop.SSP1)
gini(ENE.yearly.adj$gdp.pcap.SSP2, ENE.yearly.adj$pop.SSP2)
gini(gdp.diff$gdp.pcap.SSP2, gdp.diff$pop.SSP2)
gini(ENE.yearly.adj$gdp.pcap.SSP4, ENE.yearly.adj$pop.SSP4)
gini(gdp.diff$gdp.pcap.SSP4, gdp.diff$pop.SSP4)
# }
CumulEnergyGDP <- function(elas="base") {
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
}
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp.pcap, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop) %>%
mutate_(tot.ene.SSP2=paste0(ene.SSP2, "*pop.SSP2")) %>%
mutate_(tot.ene.SSP1=paste0(ene.SSP1, "*pop.SSP1")) %>%
mutate_(tot.ene.SSP4=paste0(ene.SSP2, "*pop.SSP4")) %>%
arrange(gdp.pcap.SSP2) %>% #arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp.pcap*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
return(cum.tot)
}
PlotIntensityVsGDPpcap <- function(elas="base") {
# Population bubble with intensities
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
title.elas <- paste0("Elasticity=", elas.max.cty)
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
title.elas <- paste0("Elasticity=", elas.min.cty)
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
title.elas <- paste0("Elasticity=", formatC(elas.base.cty, digits = 1, format="f"))
}
ggplot(ENE.yearly.adj %>% filter(pop>5e7), aes(x=gdp.pcap, y=inten.gdp)) +
# geom_point(aes(size=pop, alpha=.02, color="Base 2013")) +
scale_size(range = c(1,15)) +
# geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP1, y=eval(as.symbol(ene.SSP1))/gdp.pcap.SSP1, size=pop.SSP1, alpha=.02, color="SSP1 2050")) +
geom_text(aes(x=gdp.pcap.SSP1, y=eval(as.symbol(ene.SSP1))/gdp.pcap.SSP1, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP2, y=eval(as.symbol(ene.SSP2))/gdp.pcap.SSP2, size=pop.SSP2, alpha=.02, color="SSP2 2050")) +
geom_text(aes(x=gdp.pcap.SSP2, y=eval(as.symbol(ene.SSP2))/gdp.pcap.SSP2, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP4, y=eval(as.symbol(ene.SSP4))/gdp.pcap.SSP4, size=pop.SSP4, alpha=.02, color="SSP4 2050")) +
geom_text(aes(x=gdp.pcap.SSP4, y=eval(as.symbol(ene.SSP4))/gdp.pcap.SSP4, label=iso3c), size = 2.5, hjust=1) +
geom_line(aes(x=gdp.pcap, y=exp(eqn$coefficients[1])*gdp.pcap^(eqn$coefficients[2]-1))) +
labs(x="GDP per capita (in log)", y="Energy intensity (kgoe/$) (in log)", title=title.elas)+
scale_alpha(guide = 'none') +
scale_x_log10() + scale_y_log10()
}
print(cum.tot %>% select(starts_with("intensity.") %>% slice(n())
# Plot - Total energy per cap vs gdp/cap
# ggplot(ENE.yearly.adj %>% arrange(gdp) %>% mutate(num=1:length(gdp)), aes(x=num, y=ene)) + geom_point() +
#   geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
#   geom_point(aes(x=num, y=ene.adj.eq, color="Gini=0.3, elas=1")) +
#   geom_point(aes(x=num, y=ene.adj.eq.min, color="Gini=0.3, elas=worst"))
ggplot(ENE.yearly.adj %>% arrange(gdp.pcap) %>% mutate(num=1:length(gdp.pcap)), aes(x=gdp.pcap, y=ene)) + geom_point() +
geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
geom_line(aes(x=con.ppp, y=exp(eqn$coefficients[1])*con.ppp^(eqn$coefficients[2])))
n_group <- 10
clean.poor <- ENE.yearly.adj.ppp %>% filter(con.ppp < mean.exp - 1000) %>% arrange(inten.ppp) %>% slice(1:n_group)
dirty.poor <- ENE.yearly.adj.ppp %>% filter(con.ppp < mean.exp - 1000) %>% arrange(desc(inten.ppp)) %>% slice(1:n_group)
clean.rich <- ENE.yearly.adj.ppp %>% filter(con.ppp >= mean.exp + 1000) %>% arrange(inten.ppp) %>% slice(1:n_group)
dirty.rich <- ENE.yearly.adj.ppp %>% filter(con.ppp >= mean.exp + 1000) %>% arrange(desc(inten.ppp)) %>% slice(1:n_group)
tot.decrease <- as.numeric(ENE.yearly.adj.ppp %>% mutate(con.diff.total=(con.ppp-con.adj.eq.ppp)*pop) %>%
filter(con.diff.total>=0) %>% summarise(tot.decrease=sum(con.diff.total)))
ENE.yearly.adj.ppp.dirty <- dirty.poor %>% mutate(con.ppp.tot = con.ppp*pop) %>% mutate(con.ppp.inc = tot.decrease * con.ppp.tot / sum(con.ppp.tot) / pop) %>%
mutate(con.adj.eq.ppp=con.ppp+con.ppp.inc) %>% select(-con.ppp.tot, -con.ppp.inc) %>%
rbind(ENE.yearly.adj.ppp %>% filter(!iso2c %in% dirty.poor$iso2c) %>% mutate_cond(con.ppp < mean.exp, con.adj.eq.ppp=con.ppp))
ENE.yearly.adj.ppp.clean <- clean.poor %>% mutate(con.ppp.tot = con.ppp*pop) %>% mutate(con.ppp.inc = tot.decrease * con.ppp.tot / sum(con.ppp.tot) / pop) %>%
mutate(con.adj.eq.ppp=con.ppp+con.ppp.inc) %>% select(-con.ppp.tot, -con.ppp.inc) %>%
rbind(ENE.yearly.adj.ppp %>% filter(!iso2c %in% clean.poor$iso2c) %>% mutate_cond(con.ppp < mean.exp, con.adj.eq.ppp=con.ppp))
print(c(sum(ENE.yearly.adj.ppp.clean$con.adj.eq.ppp), sum(ENE.yearly.adj.ppp.dirty$con.adj.eq.ppp)))
# GDP difference between now and future
gdp.diff <- ENE.yearly.adj %>% select(iso3c, contains("pop."), contains("gdp.pcap")) %>% mutate_at(vars(contains("gdp.pcap")), funs(.-gdp.pcap))
gdp.diff <- gdp.diff %>% mutate_cond(gdp.pcap.SSP1 < 0, gdp.pcap.SSP1=0)
Lc(gdp.diff$gdp.pcap.SSP1, gdp.diff$pop.SSP1, plot=TRUE)
gini(ENE.yearly.adj$gdp.pcap.SSP1, ENE.yearly.adj$pop.SSP1)
gini(gdp.diff$gdp.pcap.SSP1, gdp.diff$pop.SSP1)
gini(ENE.yearly.adj$gdp.pcap.SSP2, ENE.yearly.adj$pop.SSP2)
gini(gdp.diff$gdp.pcap.SSP2, gdp.diff$pop.SSP2)
gini(ENE.yearly.adj$gdp.pcap.SSP4, ENE.yearly.adj$pop.SSP4)
gini(gdp.diff$gdp.pcap.SSP4, gdp.diff$pop.SSP4)
# }
CumulEnergyGDP <- function(elas="base") {
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
}
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp.pcap, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop) %>%
mutate_(tot.ene.SSP2=paste0(ene.SSP2, "*pop.SSP2")) %>%
mutate_(tot.ene.SSP1=paste0(ene.SSP1, "*pop.SSP1")) %>%
mutate_(tot.ene.SSP4=paste0(ene.SSP2, "*pop.SSP4")) %>%
arrange(gdp.pcap.SSP2) %>% #arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp.pcap*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
return(cum.tot)
}
PlotIntensityVsGDPpcap <- function(elas="base") {
# Population bubble with intensities
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
title.elas <- paste0("Elasticity=", elas.max.cty)
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
title.elas <- paste0("Elasticity=", elas.min.cty)
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
title.elas <- paste0("Elasticity=", formatC(elas.base.cty, digits = 1, format="f"))
}
ggplot(ENE.yearly.adj %>% filter(pop>5e7), aes(x=gdp.pcap, y=inten.gdp)) +
# geom_point(aes(size=pop, alpha=.02, color="Base 2013")) +
scale_size(range = c(1,15)) +
# geom_text(aes(label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP1, y=eval(as.symbol(ene.SSP1))/gdp.pcap.SSP1, size=pop.SSP1, alpha=.02, color="SSP1 2050")) +
geom_text(aes(x=gdp.pcap.SSP1, y=eval(as.symbol(ene.SSP1))/gdp.pcap.SSP1, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP2, y=eval(as.symbol(ene.SSP2))/gdp.pcap.SSP2, size=pop.SSP2, alpha=.02, color="SSP2 2050")) +
geom_text(aes(x=gdp.pcap.SSP2, y=eval(as.symbol(ene.SSP2))/gdp.pcap.SSP2, label=iso3c), size = 2.5, hjust=1) +
geom_point(aes(x=gdp.pcap.SSP4, y=eval(as.symbol(ene.SSP4))/gdp.pcap.SSP4, size=pop.SSP4, alpha=.02, color="SSP4 2050")) +
geom_text(aes(x=gdp.pcap.SSP4, y=eval(as.symbol(ene.SSP4))/gdp.pcap.SSP4, label=iso3c), size = 2.5, hjust=1) +
geom_line(aes(x=gdp.pcap, y=exp(eqn$coefficients[1])*gdp.pcap^(eqn$coefficients[2]-1))) +
labs(x="GDP per capita (in log)", y="Energy intensity (kgoe/$) (in log)", title=title.elas)+
scale_alpha(guide = 'none') +
scale_x_log10() + scale_y_log10()
}
print(cum.tot %>% select(starts_with("intensity.") %>% slice(n())))
?slice
print(cum.tot %>% select(starts_with("intensity.") %>% slice(row_number() == n())))
cum.tot %>% select(starts_with("intensity.") %>% slice(row_number() == n()))
cum.tot %>% select(starts_with("intensity.")
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(row_number() == n()))
cum.tot %>% select(starts_with("intensity."))
CumulEnergyGDP <- function(elas="base") {
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
}
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp.pcap, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop) %>%
mutate_(tot.ene.SSP2=paste0(ene.SSP2, "*pop.SSP2")) %>%
mutate_(tot.ene.SSP1=paste0(ene.SSP1, "*pop.SSP1")) %>%
mutate_(tot.ene.SSP4=paste0(ene.SSP2, "*pop.SSP4")) %>%
arrange(gdp.pcap.SSP2) %>% #arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp.pcap*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
# Derive global average intensities for total now and in 2050 and for the difference
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4,
intensity.SSP1.diff=(cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now),
intensity.SSP2.diff=(cum.ene.SSP2-cum.ene.now)/(cum.gdp.SSP2-cum.gdp.now),
intensity.SSP4.diff=(cum.ene.SSP4-cum.ene.now)/(cum.gdp.SSP4-cum.gdp.now))
return(cum.tot)
}
elas.case <- "base" # "max"  # "min" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# ggplot(cum.tot, aes(x=cum.gdp.SSP1, y=cum.ene.SSP1, color="SSP1 (g=0.3, e=0.89)")) + geom_line() + geom_point(aes(shape="SSP1")) +
#   geom_line(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, color="SSP2 (g=0.36, e=0.89)")) +
#   geom_point(aes(x=cum.gdp.SSP2, y=cum.ene.SSP2, shape="SSP2")) +
#   geom_line(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, color="SSP4 (g=0.45, e=0.89)")) +
#   geom_point(aes(x=cum.gdp.SSP4, y=cum.ene.SSP4, shape="SSP4")) +
#   geom_line(aes(x=cum.gdp.now, y=cum.ene.now, color="2013 (g=0.46)")) +
#   geom_point(aes(x=cum.gdp.now, y=cum.ene.now, shape="2013")) +
#   geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1000), aes(label=iso3c), size = 2.5) +
#   labs(x="Total GDP in 2050 (b$)", y="Cumulative total energy  in 2050 (kgoe)")
#   # geom_text(aes(x=cum.gdp.SSP4, y=int.base.SSP4, label=formatC(cum.ene.SSP4, digits = 1, format="f")), size = 2.5, hjust=1) +
#   # geom_text(aes(x=cum.gdp.SSP1, y=int.base.SSP1, label=formatC(cum.ene.SSP1, digits = 1, format="f")), size = 2.5, hjust=1)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(row_number() == n()))
cum.tot %>% select(starts_with("intensity."))
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()))
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e8)
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
elas.case <- "base" # "max"  # "min" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
elas.case <- "max"  # "min" # "base" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
elas.case <- # "min" # "base" # "max"
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
elas.case <- "min" # "base" # "max"  #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
0.08354698          /0.09043366
elas.case <- "max"  # "min" # "base" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
elas.case <- "min" # "base" # "max"  #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
elas.case <- "base" # "max"  #  "min" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
CumulEnergyGDP <- function(elas="base") {
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
}
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp.pcap, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop) %>%
mutate_(tot.ene.SSP2=paste0(ene.SSP2, "*pop.SSP2")) %>%
mutate_(tot.ene.SSP1=paste0(ene.SSP1, "*pop.SSP1")) %>%
mutate_(tot.ene.SSP4=paste0(ene.SSP4, "*pop.SSP4")) %>%
mutate(int.cty.SSP2=tot.ene.SSP2/gdp.SSP2, int.cty.SSP1=tot.ene.SSP2/gdp.SSP1, int.cty.SSP4=tot.ene.SSP2/gdp.SSP4) %>%
arrange(gdp.pcap.SSP2) %>% #arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp.pcap*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
# Derive global average intensities for total now and in 2050 and for the difference
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4,
intensity.SSP1.diff=(cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now),
intensity.SSP2.diff=(cum.ene.SSP2-cum.ene.now)/(cum.gdp.SSP2-cum.gdp.now),
intensity.SSP4.diff=(cum.ene.SSP4-cum.ene.now)/(cum.gdp.SSP4-cum.gdp.now))
return(cum.tot)
}
elas.case <- "max"  #  "min" # "base" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
CumulEnergyGDP <- function(elas="base") {
if(elas=="max") {
ene.SSP1 <- "ene.max.SSP1"
ene.SSP2 <- "ene.max.SSP2"
ene.SSP4 <- "ene.max.SSP4"
}else if(elas=="min") {
ene.SSP1 <- "ene.min.SSP1"
ene.SSP2 <- "ene.min.SSP2"
ene.SSP4 <- "ene.min.SSP4"
}else {
ene.SSP1 <- "ene.base.SSP1"
ene.SSP2 <- "ene.base.SSP2"
ene.SSP4 <- "ene.base.SSP4"
}
cum.tot <- ENE.yearly.adj %>% select(iso3c, gdp.pcap, ene, pop, contains("SSP1"), contains("SSP2"), contains("SSP4")) %>%
mutate(tot.ene.now=ene*pop) %>%
mutate_(tot.ene.SSP2=paste0(ene.SSP2, "*pop.SSP2")) %>%
mutate_(tot.ene.SSP1=paste0(ene.SSP1, "*pop.SSP1")) %>%
mutate_(tot.ene.SSP4=paste0(ene.SSP4, "*pop.SSP4")) %>%
mutate(int.cty.SSP2=tot.ene.SSP2/gdp.SSP2, int.cty.SSP1=tot.ene.SSP1/gdp.SSP1, int.cty.SSP4=tot.ene.SSP4/gdp.SSP4) %>%
arrange(gdp.pcap.SSP2) %>% #arrange(desc(tot.ene.SSP2)) %>%
mutate(cum.ene.now = cumsum(tot.ene.now), cum.ene.SSP2 = cumsum(tot.ene.SSP2),
cum.ene.SSP1 = cumsum(tot.ene.SSP1), cum.ene.SSP4 = cumsum(tot.ene.SSP4),
cum.gdp.now = cumsum(gdp.pcap*pop/1e9), cum.gdp.SSP2 = cumsum(gdp.SSP2), # billion$
cum.gdp.SSP1 = cumsum(gdp.SSP1), cum.gdp.SSP4 = cumsum(gdp.SSP4))
cum.tot <- rbind(0,cum.tot)
# Derive global average intensities for total now and in 2050 and for the difference
cum.tot <- cum.tot %>% mutate(intensity.now=cum.ene.now/cum.gdp.now, intensity.SSP1=cum.ene.SSP1/cum.gdp.SSP1,
intensity.SSP2=cum.ene.SSP2/cum.gdp.SSP2, intensity.SSP4=cum.ene.SSP4/cum.gdp.SSP4,
intensity.SSP1.diff=(cum.ene.SSP1-cum.ene.now)/(cum.gdp.SSP1-cum.gdp.now),
intensity.SSP2.diff=(cum.ene.SSP2-cum.ene.now)/(cum.gdp.SSP2-cum.gdp.now),
intensity.SSP4.diff=(cum.ene.SSP4-cum.ene.now)/(cum.gdp.SSP4-cum.gdp.now))
return(cum.tot)
}
elas.case <- "max"  #  "min" # "base" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
elas.case <- "max"  #  "min" # "base" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
elas.case <-  "min" # "base" # "max"  #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
elas.case <-  "base" # "max"  # "min" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
elas.case <- "max"  # "min" # "base" #
elas.cty <- formatC(if(elas.case=="base") elas.base.cty else if(elas.case=="max") elas.max.cty else elas.min.cty,
digits = 2, format="f")
cum.tot <- CumulEnergyGDP(elas.case)
# show intensity.change
print(cum.tot %>% select(starts_with("intensity.")) %>% slice(n()) / 1e9)
ggplot(cum.tot, aes(x=cum.gdp.SSP1-cum.gdp.now, y=cum.ene.SSP1-cum.ene.now, color="SSP1 (g=0.30)")) + geom_line() + geom_point(color="pink", aes(shape="SSP1")) +
geom_line(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, color="SSP2 (g=0.36)")) +
geom_point(aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, shape="SSP2"), color="green") +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(x=cum.gdp.SSP2-cum.gdp.now, y=cum.ene.SSP2-cum.ene.now, label=iso3c), size = 2.5, color="red") +
geom_line(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, color="SSP4 (g=0.45)")) +
geom_point(aes(x=cum.gdp.SSP4-cum.gdp.now, y=cum.ene.SSP4-cum.ene.now, shape="SSP4"), color="blue") +
# geom_line(aes(x=1:dim(a)[1], y=cum.ene.now, color="2013 (g=0.46)")) +
# geom_point(aes(x=1:dim(a)[1], y=cum.ene.now, shape="5")) +
geom_text_repel(data=cum.tot %>% filter(gdp.SSP2>1200), aes(label=iso3c), size = 2.5, color="black") +
labs(x="Total GDP difference from 2013 (b$)", y="Cumulative total energy difference from 2013 (kgoe)", title=paste0("Between-country elasticity=", elas.cty)) +
geom_line(aes(x=cum.gdp.SSP1-cum.gdp.now, y=sum(tot.ene.SSP1-tot.ene.now)/sum(gdp.SSP1-gdp.pcap*pop/1e9)*(cum.gdp.SSP1-cum.gdp.now)), color="yellow")
ggplot(ENE.yearly.adj %>% arrange(gdp.pcap) %>% mutate(num=1:length(gdp.pcap)), aes(x=gdp.pcap, y=ene)) + geom_point() +
geom_text_repel(aes(label=iso3c), size = 2.5) + ylab("Primary energy per cap (kgoe)") +
geom_line(aes(x=con.ppp, y=exp(eqn$coefficients[1])*con.ppp^(eqn$coefficients[2])))
